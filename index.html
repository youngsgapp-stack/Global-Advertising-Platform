<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billionaire Map - Own a Piece of Earth</title>
    <meta name="description" content="Claim your spot on the world map, decorate with pixels, and climb the rankings!">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📍</text></svg>">
    
    <!-- Mapbox GL JS -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    
    <!-- Google Fonts - Pretendard -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    
    <!-- v2 CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/panels.css">
    <link rel="stylesheet" href="css/pixel-editor.css">
    <link rel="stylesheet" href="css/ranking.css">
    <link rel="stylesheet" href="css/timeline.css">
    <link rel="stylesheet" href="css/recommendation.css">
    <link rel="stylesheet" href="css/onboarding.css">
    
    <style>
        /* Additional inline styles (fast loading) */
        body {
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
            animation-delay: 0.2s;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="map-container">
        <!-- Stars Background Canvas -->
        <canvas id="stars-canvas"></canvas>
        
        <!-- Mapbox Map -->
        <div id="map"></div>
        
        <!-- Hamburger Menu Button -->
        <button id="hamburger-menu-btn" class="hamburger-menu-btn" aria-label="Open menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- Side Menu -->
        <aside id="side-menu" class="side-menu hidden">
            <div class="side-menu-header">
                <h3>📍 Menu</h3>
                <button id="close-side-menu" class="close-btn" aria-label="Close menu">&times;</button>
            </div>
            <div class="side-menu-content">
                <!-- User Section -->
                <section class="side-menu-section">
                    <h4>👤 Account</h4>
                    <button id="side-user-login-btn" class="side-menu-btn">
                        🔐 Sign In
                    </button>
                    <button id="side-user-logout-btn" class="side-menu-btn hidden">
                        🚪 Sign Out
                    </button>
                    <span id="side-user-email" class="side-user-email hidden"></span>
                </section>
                
                <!-- Territory Filter Section -->
                <section class="side-menu-section">
                    <h4>🗺️ Browse Territories</h4>
                    <button id="side-available-btn" class="side-menu-btn filter-btn" data-filter="available">
                        🏴 Available <span class="count-badge" id="count-available">0</span>
                    </button>
                    <button id="side-auction-btn" class="side-menu-btn filter-btn" data-filter="auction">
                        🔥 In Auction <span class="count-badge" id="count-auction">0</span>
                    </button>
                    <button id="side-owned-btn" class="side-menu-btn filter-btn" data-filter="owned">
                        🏰 Owned <span class="count-badge" id="count-owned">0</span>
                    </button>
                </section>
                
                <!-- Ranking Section -->
                <section class="side-menu-section">
                    <h4>🏆 Rankings</h4>
                    <button id="side-ranking-btn" class="side-menu-btn">
                        📊 Top Owners
                    </button>
                    <button id="side-my-territories-btn" class="side-menu-btn">
                        📍 My Spots
                    </button>
                </section>
                
                <!-- Help Section -->
                <section class="side-menu-section">
                    <h4>❓ Help</h4>
                    <button id="side-tutorial-btn" class="side-menu-btn">
                        🎓 Tutorial
                    </button>
                    <button id="side-help-btn" class="side-menu-btn">
                        📖 How to Play
                    </button>
                    <button id="side-about-btn" class="side-menu-btn">
                        ℹ️ About
                    </button>
                </section>
                
                <!-- Version Info -->
                <div class="version-info" style="margin-top: auto; padding-top: 20px; text-align: center; color: var(--color-text-muted); font-size: 12px;">
                    v2.0.0 · Own a Piece 🌍
                </div>
            </div>
        </aside>
        
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>📍 Billionaire Map</h1>
                <p>Own a Piece of Earth</p>
            </div>
            <!-- Wallet Display (hidden by default, shown on login) -->
            <div class="header-wallet hidden" id="header-wallet">
                <button class="wallet-btn" id="open-wallet-modal" title="Your Wallet">
                    <span class="wallet-icon">💰</span>
                    <span class="wallet-balance" id="header-wallet-balance">0 pt</span>
                </button>
            </div>
        </header>
        
        <!-- View Mode Toggle & Country Selector -->
        <div class="map-controls">
            <button id="view-mode-toggle" class="view-toggle-btn" title="Toggle World/Country View">
                🌍 World
            </button>
            <div class="map-mode-toggle">
                <select id="country-selector">
                    <option value="">Select Country...</option>
                </select>
            </div>
        </div>
        
        <!-- Territory Panel (dynamically rendered) -->
        <div id="territory-panel" class="territory-panel hidden"></div>
        
        <!-- Territory List Panel -->
        <div id="territory-list-panel" class="territory-list-panel hidden">
            <div class="territory-list-header">
                <h3 id="territory-list-title">🗺️ Territories</h3>
                <button id="close-territory-list" class="close-btn">&times;</button>
            </div>
            <div class="territory-list-filters">
                <button class="filter-tab active" data-filter="all">All</button>
                <button class="filter-tab" data-filter="available">🏴 Available</button>
                <button class="filter-tab" data-filter="auction">🔥 Auction</button>
                <button class="filter-tab" data-filter="owned">🏰 Owned</button>
            </div>
            <div class="territory-list-search">
                <input type="text" id="territory-search" placeholder="🔍 Search territories...">
            </div>
            <div class="territory-list-content" id="territory-list-content">
                <!-- Dynamically rendered -->
            </div>
            <div class="territory-list-footer">
                <span id="territory-list-count">0 territories</span>
            </div>
        </div>
        
        <!-- Ranking Board -->
        <aside class="ranking-board" id="ranking-board">
            <!-- RankingBoard.js에서 동적 렌더링 -->
        </aside>
        
        <!-- Mobile Ranking Button -->
        <button class="ranking-mobile-btn" id="ranking-mobile-btn" title="View Rankings">🏆</button>
        
        <!-- Timeline Widget -->
        <aside class="timeline-widget" id="timeline-widget">
            <div class="timeline-header">
                <h4>📜 Live Activity</h4>
                <button class="timeline-toggle" id="timeline-toggle">−</button>
            </div>
            <div class="timeline-content" id="timeline-content">
                <!-- Rendered by HistoryLogger -->
            </div>
        </aside>
        
        <!-- Loading Indicator -->
        <div id="loading">
            <div class="spinner"></div>
            <p>🌍 Loading the world...</p>
        </div>
        
        <!-- Admin Login Modal (P키 5번 연타로 열기) -->
        <div id="admin-login-modal" class="modal hidden">
            <div class="modal-overlay"></div>
            <div class="modal-content admin-modal">
                <button class="modal-close" id="close-admin-modal">&times;</button>
                <div class="modal-header">
                    <h2>🔐 관리자 로그인</h2>
                    <p>Firebase 계정으로 로그인</p>
                </div>
                <form id="admin-login-form-main">
                    <div class="form-group">
                        <label for="admin-email">이메일</label>
                        <input type="email" id="admin-email" placeholder="admin@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="admin-pwd">비밀번호</label>
                        <input type="password" id="admin-pwd" placeholder="••••••••" required>
                    </div>
                    <button type="submit" class="btn-primary btn-full">
                        🔓 로그인
                    </button>
                    <div id="admin-login-error" class="error-message hidden"></div>
                </form>
                <div class="modal-footer">
                    <small>💡 P키 5번 연타로 이 모달을 열 수 있습니다</small>
                </div>
            </div>
        </div>
        
        <!-- 관리자 사용자 모드 배너 -->
        <div id="admin-user-mode-banner" class="admin-user-mode-banner hidden">
            <span>🎭 관리자로 사용자 체험 중</span>
            <button id="back-to-admin" class="btn-back-admin">관리자 페이지로 돌아가기</button>
        </div>
        
        <!-- Onboarding Welcome Modal -->
        <div id="onboarding-modal" class="onboarding-modal hidden">
            <div class="onboarding-overlay"></div>
            <div class="onboarding-container">
                <button class="onboarding-skip" id="onboarding-skip">Skip →</button>
                
                <!-- Slides -->
                <div class="onboarding-slides" id="onboarding-slides">
                    <!-- Slide 1: Welcome -->
                    <div class="onboarding-slide active" data-slide="0">
                        <div class="slide-content">
                            <div class="slide-icon">🌍</div>
                            <h1>Welcome to <span class="brand">Billionaire Map</span></h1>
                            <p class="slide-subtitle">Own a Piece of Earth</p>
                            <p class="slide-description">
                                전 세계 지도에서 실제 행정구역을 구매하여<br>
                                나만의 영토를 소유하세요!
                            </p>
                            <div class="slide-features">
                                <span>🏴 영토 구매</span>
                                <span>🎨 픽셀 아트</span>
                                <span>🏆 랭킹 경쟁</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Slide 2: How it works -->
                    <div class="onboarding-slide" data-slide="1">
                        <div class="slide-content">
                            <div class="slide-icon">🗺️</div>
                            <h2>어떻게 작동하나요?</h2>
                            <div class="how-it-works">
                                <div class="step">
                                    <div class="step-number">1</div>
                                    <div class="step-info">
                                        <h4>영토 선택</h4>
                                        <p>지도에서 원하는 지역을 클릭하세요</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <div class="step-number">2</div>
                                    <div class="step-info">
                                        <h4>포인트 충전</h4>
                                        <p>PayPal로 포인트를 충전하세요</p>
                                    </div>
                                </div>
                                <div class="step">
                                    <div class="step-number">3</div>
                                    <div class="step-info">
                                        <h4>영토 구매</h4>
                                        <p>즉시 구매 또는 경매로 영토를 획득!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Slide 3: Features -->
                    <div class="onboarding-slide" data-slide="2">
                        <div class="slide-content">
                            <div class="slide-icon">✨</div>
                            <h2>무엇을 할 수 있나요?</h2>
                            <div class="feature-cards">
                                <div class="feature-card">
                                    <span class="feature-icon">🎨</span>
                                    <h4>픽셀 아트 꾸미기</h4>
                                    <p>내 영토를 100x100 픽셀 캔버스로 꾸미세요</p>
                                </div>
                                <div class="feature-card">
                                    <span class="feature-icon">⚔️</span>
                                    <h4>경매 참여</h4>
                                    <p>다른 영토에 입찰하여 영토를 확장하세요</p>
                                </div>
                                <div class="feature-card">
                                    <span class="feature-icon">👥</span>
                                    <h4>협업 모드</h4>
                                    <p>친구들과 함께 픽셀 아트를 그리세요</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Slide 4: Pricing -->
                    <div class="onboarding-slide" data-slide="3">
                        <div class="slide-content">
                            <div class="slide-icon">💰</div>
                            <h2>영토 가격은 어떻게 되나요?</h2>
                            <div class="pricing-info">
                                <div class="pricing-card">
                                    <div class="price-range">100 pt ~ 100K+ pt</div>
                                    <p>영토마다 가격이 다릅니다</p>
                                </div>
                                <ul class="pricing-factors">
                                    <li>📍 인구 밀도에 따라 가격 책정</li>
                                    <li>🏙️ 대도시 지역은 더 높은 가격</li>
                                    <li>🛡️ 구매 후 7일간 소유권 보호</li>
                                    <li>🔥 경매는 더 낮은 가격에 시작 가능</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Slide 5: Get Started -->
                    <div class="onboarding-slide" data-slide="4">
                        <div class="slide-content">
                            <div class="slide-icon">🚀</div>
                            <h2>시작할 준비가 되셨나요?</h2>
                            <p class="slide-description">
                                Google 계정으로 간편하게 로그인하고<br>
                                나만의 영토를 차지하세요!
                            </p>
                            <div class="cta-buttons">
                                <button class="cta-primary" id="onboarding-login">
                                    🔐 로그인하고 시작하기
                                </button>
                                <button class="cta-secondary" id="onboarding-explore">
                                    🗺️ 먼저 둘러보기
                                </button>
                            </div>
                            <p class="cta-hint">* 둘러보기는 로그인 없이도 가능합니다</p>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <div class="onboarding-nav">
                    <button class="nav-btn prev" id="onboarding-prev" disabled>
                        ← 이전
                    </button>
                    <div class="nav-dots" id="onboarding-dots">
                        <span class="dot active" data-slide="0"></span>
                        <span class="dot" data-slide="1"></span>
                        <span class="dot" data-slide="2"></span>
                        <span class="dot" data-slide="3"></span>
                        <span class="dot" data-slide="4"></span>
                    </div>
                    <button class="nav-btn next" id="onboarding-next">
                        다음 →
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mapbox GL JS -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    
    <!-- PayPal SDK (Live - World Map Advertising) -->
    <script src="https://www.paypal.com/sdk/js?client-id=AQirNO21I_osrvoS7tvhGdtpGiv9sQC8k0XCurV-xZJZNY5ZnMn_64uwppCgscPbIfX2m1Nn9Z-TTPVp&currency=USD" async></script>
    
    <!-- v2 App Module - 캐시 무효화를 위한 버전 추가 -->
    <script type="module" src="js/app.js?v=20251202-2"></script>
</body>
</html>

